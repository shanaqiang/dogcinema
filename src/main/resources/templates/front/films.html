<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>狗眼影院</title>
    <meta charset="utf-8">
    <link rel="stylesheet" th:href="@{/front/css/common.css}"/>
    <link rel="stylesheet" th:href="@{/front/css/movie.css}"/>
    <link rel="stylesheet" th:href="@{/front/css/bootstrap.min.4.3.1.css}">
    <script th:src="@{/background/js/jquery.min.js}"></script>
    <script th:src="@{/background/layer/layer.js}"></script>
    <script th:src="@{/front/js/vue.min.2.6.10.js}"></script>

</head>
<body>

<!--导航栏-->
<div th:replace="front/common::common-header(activeUri='/films')"></div>

<!--顶部黑色-->
<div class="subnav">
    <ul class="navbar">
        <li>
            <a data-act="subnav-click" data-val="{subnavClick:1}"
               data-state-val="{subnavId:1}"
               class="active" href="javascript:void(0);"
            >正在热映</a>
        </li>
        <li>
            <a data-act="subnav-click" data-val="{subnavClick:2}"
               href="javascript:"
            >即将上映</a>
        </li>
        <li>
            <a data-act="subnav-click" data-val="{subnavClick:3}"
               href="javascript:"
            >经典影片</a>
        </li>
    </ul>
</div>


<div class="container" id="app">

    <!--电影类型选项-->
    <div class="movies-channel">
        <div class="tags-panel">
            <ul class="tags-lines">
                <li class="tags-line" data-val="{tagTypeName:'cat'}">
                    <div class="tags-title">类型 :</div>
                    <ul class="tags" id="type">
                        <li class="active">
                            <a href="javascript:">全部</a>
                        </li>
                        <li>
                            <a href="javascript:">动作</a>
                        </li>
                        <li>
                            <a href="javascript:">古装</a>
                        </li>
                        <li>
                            <a href="javascript:">爱情</a>
                        </li>
                        <li>
                            <a href="javascript:">喜剧</a>
                        </li>
                        <li>
                            <a href="javascript:">科幻</a>
                        </li>
                        <li>
                            <a href="javascript:">悬疑</a>
                        </li>
                        <li>
                            <a href="javascript:">惊悚</a>
                        </li>
                        <li>
                            <a href="javascript:">恐怖</a>
                        </li>
                        <li>
                            <a href="javascript:">传记</a>
                        </li>
                        <li>
                            <a href="javascript:">战争</a>
                        </li>
                        <li>
                            <a href="javascript:">剧情</a>
                        </li>
                        <li>
                            <a href="javascript:">冒险</a>
                        </li>
                        <li>
                            <a href="javascript:">纪录片</a>
                        </li>
                        <li>
                            <a href="javascript:">其他</a>
                        </li>
                    </ul>
                </li>

                <li class="tags-line tags-line-border" data-val="{tagTypeName:'source'}">
                    <div class="tags-title">区域 :</div>
                    <ul class="tags" id="country">
                        <li class="active">
                            <a href="javascript:">全部</a>
                        </li>
                        <li>
                            <a href="javascript:">大陆</a>
                        </li>
                        <li>
                            <a href="javascript:">美国</a>
                        </li>
                        <li>
                            <a href="javascript:">韩国</a>
                        </li>
                        <li>
                            <a href="javascript:">日本</a>
                        </li>
                        <li>
                            <a href="javascript:">中国香港</a>
                        </li>
                        <li>
                            <a href="javascript:">中国台湾</a>
                        </li>
                        <li>
                            <a href="javascript:">泰国</a>
                        </li>
                        <li>
                            <a href="javascript:" >印度</a>
                        </li>
                        <li>
                            <a href="javascript:">法国</a>
                        </li>
                        <li>
                            <a href="javascript:">英国</a>
                        </li>
                        <li>
                            <a href="javascript:">俄罗斯</a>
                        </li>
                        <li>
                            <a href="javascript:">意大利</a>
                        </li>
                        <li>
                            <a href="javascript:">西班牙</a>
                        </li>
                        <li>
                            <a href="javascript:">其他</a>
                        </li>
                    </ul>
                </li>
                <li class="tags-line tags-line-border" data-val="{tagTypeName:'year'}">
                    <div class="tags-title">年代 :</div>
                    <ul class="tags" id="year">
                        <li class="active">
                            <a href="javascript:">全部</a>
                        </li>
                        <li>
                            <a href="javascript:">2019</a>
                        </li>
                        <li>
                            <a href="javascript:">2018</a>
                        </li>
                        <li>
                            <a href="javascript:">2017</a>
                        </li>
                        <li>
                            <a href="javascript:">2016</a>
                        </li>
                        <li>
                            <a href="javascript:">2015</a>
                        </li>
                        <li>
                            <a href="javascript:">2014</a>
                        </li>
                        <li>
                            <a href="javascript:">2013</a>
                        </li>
                        <li>
                            <a href="javascript:">2012</a>
                        </li>
                        <li>
                            <a href="javascript:">2011</a>
                        </li>
                        <li>
                            <a href="javascript:">更早</a>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
        <div class="movies-panel">
            <div class="movies-sorter">
                <div class="cat-sorter">
                    <ul>
                        <li>
                            <span class="sort-control-group" data-act='sort-click' data-val="{tagId: 1 }" style="cursor: default">
                              <span class="sort-control sort-radio sort-radio-checked"></span>
                              <span class="sort-control-label">按时间排序</span>
                            </span>
                        </li>
                        <li>
                            <span class="sort-control-group" data-act='sort-click' data-val="{tagId: 2 }" data-href="?sortId=2" onclick="location.href=this.getAttribute('data-href')">
                              <span class="sort-control sort-radio"></span>
                              <span class="sort-control-label">按热门排序</span>
                            </span>
                        </li>
                        <li>
                            <span class="sort-control-group" data-act='sort-click' data-val="{tagId: 3 }" data-href="?sortId=3" onclick="location.href=this.getAttribute('data-href')">
                              <span class="sort-control sort-radio"></span>
                              <span class="sort-control-label">按评价排序</span>
                            </span>
                        </li>
                    </ul>
                </div>
                <div class="play-sorter">
                    <span class="sort-control-group" data-act='isplay-click' data-val="{isplay:1}" data-href="?isPlay=1" onclick="location.href=this.getAttribute('data-href')">
                      <span class="sort-control sort-checkbox"></span>
                      <span class="sort-control-label">可播放</span>
                    </span>
                </div>
            </div>


            <!--电影显示界面-->
            <div class="movies-list">
                <dl class="movie-list">
                    <dd v-for="f in films">
                        <div class="movie-item">
                            <a :href="'/qfilmdetails/details/'+f.fid">
                                <div class="movie-poster">
                                    <img v-bind:src="f.filmimg"/>
                                </div>
                            </a>
                        </div>
                        <div class="channel-detail movie-item-title" th:title="f.fname">
                            <a :href="'/qfilmdetails/details/'+f.fid" target="_blank" data-act="movies-click" data-val="{movieId:1211270}">{{f.fname}}</a>
                        </div>
                        <div class="channel-detail channel-detail-orange"><i class="integer">{{f.score}}</i></div>
                </dl>
            </div>

            <!--//分页-->
            <div class="movies-pager">
                <ul class="list-pager">
                    <li v-for="p in pages" v-if="p===pageinfo.pageNum" class="active">
                        <a class="page_1" href="javascript:" style="cursor: default" @click.prevent="page(p)">{{p}}</a>
                    </li>
                    <li v-else>
                        <a class="page_1" href="javascript:" style="cursor: default" @click.prevent="page(p)">{{p}}</a>
                    </li>
                    <li><a class="page_2" href="javascript:" onclick="nextpage()">下一页</a> </li>
                </ul>
            </div>
        </div>

    </div>
</div>
<div th:replace="front/common::common-footer"></div>




</body>

<script>
    var app=new Vue({
        el:"#app",
        data:{
            films:[],
            pages:3,
            pageinfo:{},
        },

    })

    var country;
    var year;
    var type;

    $(function () {
        page(1)
        


        $("#type a").click(function () {
            type=$(this).text()
            $("#type li").attr("class","")
            $(this).parent().attr("class","active")
            page(1)
        })

        $("#country a").click(function () {
            $("#country li").attr("class","")
            $(this).parent().attr("class","active")
            country=$(this).text()
            page(1)
        })

        $("#year a").click(function () {
            $("#year li").attr("class","")
            $(this).parent().attr("class","active")
            year=$(this).text()
            page(1)
        })
    })

    function page(i) {
        var pagesize=app.pageinfo.pageSize
        $.post("qfilm/showallfilmsinshow",{
            pagenum:i,
            pagesize:pagesize,
            year:year,
            country:country,
            type:type,
        },function (data) {
            console.log(data);
            app.films=data.list;
            app.pages=data.pages;
            app.pageinfo=data;
        })
    }

    function nextpage(){
        var i=app.pageinfo.pageNum
        page(i+1)
    }




</script>
</html>
