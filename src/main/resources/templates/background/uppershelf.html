<!DOCTYPE html>
<html lang="en"xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <link rel="stylesheet" th:href="@{/background/layui/css/layui.css}">
    <script th:src="@{/background/layui/layui.js}"></script>
    <script th:src="@{/background/js/jquery.min.js}"></script>
</head>
<body class="layui-layout-body">
    <div class="layui-layout layui-layout-admin">
        <div th:replace="background/public::head"></div>
        <div th:replace="background/public::side(activeUrl='upper')"></div>
        <div class="layui-body">
            <!-- 内容主体区域 -->
            <div style="padding: 15px;"class="container">
                <div class="layui-row">
                        <div class="layui-col-md12">
                            <form class="layui-form" action="">
                                <div class="layui-form-item ">
                                    <label class="layui-form-label">电影名字</label>
                                    <div class="layui-input-inline">
                                        <input type="text" name="fname" required  lay-verify="required" placeholder="请输入电影名字" autocomplete="off" class="layui-input">
                                    </div>
                                </div>

                                <div class="layui-form-item">
                                    <label class="layui-form-label">导演名字</label>
                                    <div class="layui-input-inline">
                                        <input type="text" name="director" required lay-verify="required" placeholder="导演名字" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label class="layui-form-label">电影状态</label>
                                    <div class="layui-input-block">
                                        <input type="radio" name="status" value="0" title="未上映"checked>
                                        <input type="radio" name="status" value="1" title="正上映" >
                                        <input type="radio" name="status" value="2" title="已上映" >
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label class="layui-form-label">分类</label>
                                    <div class="layui-input-block">
                                        <input type="radio" name="recommend" value="0" title="无"checked>
                                        <input type="radio" name="recommend" value="1" title="热映" >
                                        <input type="radio" name="recommend" value="2" title="即将上映" >
                                        <input type="radio" name="recommend" value="3" title="经典" >
                                    </div>
                                </div>

                                <div class="layui-form-item">
                                    <label class="layui-form-label">上映日期</label>
                                    <div class="layui-input-inline">
                                        <input type="text" class="layui-input" name="releasedate" id="filmdate" placeholder="yyyy-MM-dd">
                                    </div>
                                </div>

                                <div class="layui-form-item">
                                    <label class="layui-form-label">电影类型</label>
                                    <div class="layui-input-block">
                                        <select name="type" lay-verify="required">
                                            <option value=""></option>
                                            <option value="动作">动作</option>
                                            <option value="古装">古装</option>
                                            <option value="爱情">爱情</option>
                                            <option value="喜剧">喜剧</option>
                                            <option value="科幻">科幻</option>
                                            <option value="悬疑">悬疑</option>
                                            <option value="惊悚">惊悚</option>
                                            <option value="恐怖">恐怖</option>
                                            <option value="传记">传记</option>
                                            <option value="战争">战争</option>
                                            <option value="剧情">剧情</option>
                                            <option value="冒险">冒险</option>
                                            <option value="纪录片">纪录片</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label class="layui-form-label">时长</label>
                                    <div class="layui-input-block">
                                        <input type="text" name="duration" required  lay-verify="required" placeholder="请输入电影时长" autocomplete="off" class="layui-input">
                                    </div>
                                </div>

                                <div class="layui-form-item">
                                    <label class="layui-form-label">上映国家</label>
                                    <div class="layui-input-inline">
                                        <input type="text" name="releasecountry" required  lay-verify="required" value="中国" autocomplete="off" readonly class="layui-input">
                                    </div>
                                    <label class="layui-form-label">出版国家</label>
                                    <div class="layui-input-inline">
                                        <select name="country" lay-verify="required">
                                            <option value=""></option>
                                            <option value="大陆">大陆</option>
                                            <option value="美国">美国</option>
                                            <option value="韩国">韩国</option>
                                            <option value="日本">日本</option>
                                            <option value="中国香港">中国香港</option>
                                            <option value="中国台湾">中国台湾</option>
                                            <option value="泰国">泰国</option>
                                            <option value="印度">印度</option>
                                            <option value="法国">法国</option>
                                            <option value="英国">英国</option>
                                            <option value="俄罗斯">俄罗斯</option>
                                            <option value="意大利">意大利</option>
                                            <option value="西班牙">西班牙</option>
                                            <option value="其它">其它</option>
                                        </select>
                                    </div>
                                    <label class="layui-form-label">语言</label>
                                    <div class="layui-input-inline">
                                        <select name="language" lay-verify="required">
                                            <option value=""></option>
                                            <option value="国语">国语</option>
                                            <option value="英语">英语</option>
                                            <option value="韩语">韩语</option>
                                            <option value="日语">日语</option>
                                            <option value="泰语">泰语</option>
                                            <option value="法语">法语</option>
                                            <option value="俄语">俄语</option>
                                            <option value="意大利语">意大利语</option>
                                            <option value="西班牙语">西班牙语</option>
                                            <option value="其它">其它</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="layui-form-item layui-form-text">
                                    <label class="layui-form-label">电影详情</label>
                                    <div class="layui-input-block">
                                        <textarea name="description" placeholder="请输入电影详情" class="layui-textarea"></textarea>
                                    </div>
                                </div>

                                <div class="layui-form-item">
                                    <label class="layui-form-label">电影图片</label>
                                    <div class="layui-input-inline uploadHeadImage">
                                        <div class="layui-upload-drag" id="filmImg">
                                            <i class="layui-icon"></i>
                                            <p>点击上传图片，或将图片拖拽到此处</p>
                                        </div>
                                    </div>
                                    <div class="layui-input-inline">
                                        <div class="layui-upload-list">
                                            <img class="layui-upload-img headImage" src="http://t.cn/RCzsdCq" id="demo1">
                                            <p id="demoText"></p>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <input text="" id="img" name="filmimg" class="layui-hide">
                                </div>

                                <div class="layui-form-item">
                                    <div class="layui-input-block">
                                        <button class="layui-btn" lay-submit lay-filter="formDemo">立即提交</button>
                                        <button type="reset" id="reset" class="layui-btn layui-btn-primary">重置</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
            </div>
        </div>



        <div th:replace="background/public::foot"></div>
    </div>

    <script>
        //JavaScript代码区域
        layui.use('element', function(){
            var element = layui.element;

        });

        layui.use(['form','layer'], function(){
            var form = layui.form;

            //监听提交
            form.on('submit(formDemo)', function(data){
                $.ajax({
                    url:"/filmController/upperfilm",
                    data:data.field,
                    type:"post",
                    dataType:"json",
                    success: function(data){
                        if(data.code=="200"){
                            layer.msg("成功上架");
                            $('#reset').click();
                        }else{
                            layer.msg("上架失败");
                        }
                    }
                });
                return false;
            });
        });


        layui.use('laydate', function(){
            var laydate = layui.laydate;
            //执行一个laydate实例
            laydate.render({
                elem: '#filmdate'//指定元素
            });
        });



        layui.use(["jquery", "upload", "form", "layer", "element"], function () {
            var $ = layui.$,
                element = layui.element,
                layer = layui.layer,
                upload = layui.upload,
                form = layui.form;
            //拖拽上传
            var uploadInst = upload.render({
                elem: '#filmImg'
                , url: '/filmController/upload'
                , size: 1024
                ,method:'POST'
                , before: function (obj) {
                    //预读本地文件示例，不支持ie8
                    obj.preview(function (index, file, result) {
                        $('#demo1').attr('src', result); //图片链接（base64）
                    });
                }
                , done: function (res) {
                    //如果上传失败
                    if (res.code > 0) {
                        return layer.msg('上传失败');
                    }
                    //上传成功
                    //打印后台传回的地址: 把地址放入一个隐藏的input中, 和表单一起提交到后台, 此处略..
                    /*   console.log(res.data.src);*/
                    $('#img').attr('value',res.maps.src);
                    var demoText = $('#demoText');
                    demoText.html('<span style="color: #8f8f8f;">上传成功!!!</span>');
                }
                , error: function () {
                    //演示失败状态，并实现重传
                    var demoText = $('#demoText');
                    demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-mini demo-reload">重试</a>');
                    demoText.find('.demo-reload').on('click', function () {
                        uploadInst.upload();
                    });
                }
            });
            element.init();
        });

        $("#reset").click(function(){
            $("#demo1").attr("src","http://t.cn/RCzsdCq");
        });

    </script>
</body>
</html>